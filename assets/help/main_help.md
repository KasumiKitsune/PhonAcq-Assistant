# 欢迎使用 PhonAcq Assistant

**PhonAcq Assistant (音韵习得实验助手)** 是一款专为语言学研究者、教师和学习者设计的集成化桌面应用程序。它致力于将繁琐的语音数据采集、语料构建、数据管理乃至后续的学习复习流程变得简单、高效和规范化。

在现代软件设计中，用户的“第一印象”至关重要。一个缓慢的启动过程不仅会消磨用户的耐心，甚至可能导致用户因误判程序无响应而重复点击。为了根除这一痛点，我们为 PhonAcq Assistant 设计并实现了一套先进的**单进程、延迟导入的瞬时启动架构**。从用户双击图标的那一刻起，程序仅用不到1秒的时间便会呈现一个精美的启动画面，为用户提供了流畅、可靠、专业的初次交互体验。

本手册将详细介绍程序的各项功能和最佳实践，希望能帮助您快速上手并充分利用它的潜力。请使用左侧的目录来导航至您感兴趣的章节。

---

## 一、核心工作流程

本程序支持多种数据采集与学习范式，您可以根据研究或学习需求选择合适的流程。

#### 通用流程

1.  **准备语料 (采集或学习前)**:
    *   **方法一 (推荐):** 前往 `语料管理 -> Excel 转换器`，下载并填写模板，然后将填写好的 `.xlsx` 文件转换为程序可用的 `.py` 词表文件。这是与不熟悉代码的协作者共享和编辑词表的最佳方式。
    *   **方法二 (直接编辑):** 
        *   标准词表: 前往 `语料管理 -> 词表编辑器` 直接创建或编辑用于“口音采集”的 `.py` 文件。
        *   图文词表: 前往 `方言研究 -> 图文词表编辑` 创建或编辑用于“图文采集”的 `.py` 文件。
2.  **生成提示音 (可选)**:
    *   **TTS批量生成**: 前往 `实用工具 -> TTS 工具`，加载您的词表，批量生成合成语音。您可以选择将其输出到速记卡模块的专用音频目录。
    *   **真人语音包**: 前往 `数据采集 -> 语音包录制`，为您的标准词表录制一套高质量的真人提示音。
3.  **开始采集 (研究)**:
    *   **口音采集**: `数据采集 -> 口音采集会话`。
    *   **方言图文采集**: `方言研究 -> 图文采集`。
4.  **开始学习 (复习)**:
    *   **速记卡**: 前往 `实用工具 -> 速记卡`，加载标准或图文词表，选择学习或自检模式，开始高效记忆。
5.  **管理数据**: 前往 `语料管理 -> 数据管理器`，在这里您可以浏览、试听、重命名、删除所有已录制的音频数据和会话文件夹。
6.  **程序设置**: 在 `系统与帮助 -> 程序设置` 中可以自定义程序行为，如主题、默认路径、音频参数（包括录音格式）、侧边栏宽度等。

<div class="tip">
<strong>提示音优先级</strong>: 在“口音采集会话”中，提示音的播放优先级为：<strong>真人语音包 > TTS语音 > 在线实时生成</strong>。建议为核心实验语料录制真人语音包以保证音质和一致性。
</div>

---

## 二、功能模块详解

### 口音采集会话
**路径**: `数据采集 -> 口音采集会话`

这是进行**文本到语音**实验的核心界面，适用于标准的朗读任务、最小音对测试、句子复述等场景。

*   **会话准备**: 您需要先选择一个 `.py` 格式的**标准词表**，并为被试者命名。系统会自动检查并生成缺失的TTS提示音，确保实验的顺利进行。
*   **范式控制**: 您可以通过“随机/顺序”和“部分/完整”开关，灵活设计实验范式，以减少顺序效应等实验偏差。
*   **无损录音**: 本模块采用**持久化音频流**技术，从会话开始便激活麦克风，彻底解决了因设备启动延迟而造成的音频开头数据丢失问题，确保语音信号的完整捕获。
*   **流程自动化**: 一次录制成功后，列表焦点会自动跳转到下一个未录制的词条。已录制的条目会有清晰的对勾标记，方便追踪进度和进行补录。
*   **数据追溯**: 每次会话都会在结果文件夹中生成一个 `log.txt` 文件，详细记录所有操作的时间戳，增强了实验数据的可追溯性和学术可信度。

### 语音包录制
**路径**: `数据采集 -> 语音包录制`

此功能旨在让研究者能够**创建一套属于自己的、高质量、发音统一的真人提示音库**，以完全替代在线TTS服务。

*   **核心流程**: 加载标准词表，逐一选中词条，通过**按住并松开**“录音”按钮或 `Enter` 键来完成录制。新的录音会自动覆盖旧版，确保留下的总是最满意的一版。
*   **关键特性**: 同样采用持久化音频流确保无延迟录音。已完成的词条会以对勾图标标记，状态一目了然。录音格式会自动遵循全局设置（WAV/MP3）。

### 方言图文采集
**路径**: `方言研究 -> 图文采集`

这是一个强大的功能，专为需要**视觉刺激**的方言调查、田野调查或儿童语言习得研究设计。

*   **核心逻辑**: 向被试者展示一张图片，并根据文字提示，请他们用方言描述图片内容或说出图中物体的名称，然后录下他们的语音。
*   **强大交互**: 图片浏览器支持**无限缩放**和**自由拖动**，便于观察细节。
*   **沉浸式体验**: 可选择在学习开始时隐藏左侧项目列表，为被试者创造一个更专注、无干扰的采集环境。

### 速记卡 (Flashcard)
**路径**: `实用工具 -> 速记卡`

“速记卡”模块是本软件从“数据采集工具”向“**学习与复习平台**”演进的核心体现。它是一个深度集成了**主动回忆**和**间隔重复**科学记忆原理的智能化学习系统。

*   **学习与自检分离**:
    *   **学习模式**: 用户可以自由浏览卡片正反面，主动跟读和记忆，此模式下没有答案输入框。
    *   **自检模式**: 程序会隐藏答案，要求用户在输入框中作答。提交后，系统会根据答案的相似度给出精准、分级的反馈。
*   **智能随机顺序**: 这是推荐的默认模式。它基于艾宾浩斯遗忘曲线原理，通过一个**加权优先级排序算法**，优先展示您**不熟悉、经常答错、或很久没复习**的词条，并智能安排已掌握词条的复习周期。
*   **进度管理**: 您所有的学习行为（浏览次数、错误次数、掌握状态、复习周期）都会被自动记录在 `flashcards/progress/` 目录下的进度文件中。

### 语料管理与编辑

#### Excel 转换器
**路径**: `语料管理 -> Excel 转换器`

**强烈推荐**使用此功能来创建您的词表。它允许不熟悉编程的合作者使用 Excel 来编辑语料，然后一键转换为程序可用的格式。模块内置多种模板，并提供详细的转换报告。

#### 通用词表编辑器
**路径**: `语料管理 -> 词表编辑器`

用于直接编辑**标准词表**（`.py`格式）。支持分组、多语言标注、撤销/重做以及全套快捷键。

#### 图文词表编辑器
**路径**: `方言研究 -> 图文词表编辑`

为“方言图文采集”和“速记卡”功能配套的编辑器。

*   **ID唯一性检查:** 编辑器会自动检测并用**红色高亮**显示任何重复的ID，确保数据完整性。
*   **智能检测**: 核心功能！在填入“项目ID”后，点击“自动检测图片”并勾选“智能检测”，它会模糊匹配并自动填充最相似的图片文件名，极大提高效率。
*   **文件选择器**: 双击“图片文件”单元格，可以直接弹出文件管理器让您选择图片。

### 系统设置
**路径**: `系统与帮助 -> 程序设置`

在这里，您可以对程序的各方面进行个性化配置，包括UI主题、默认路径、音频参数（WAV/MP3）、TTS语言、以及侧边栏宽度等。所有设置都会自动保存。

---

## 三、高级技巧与最佳实践

### 设计高效的词表
无论是标准词表还是图文词表，良好的设计都至关重要。

*   **ID 命名**: 为您的项目ID（或标准词表中的单词）使用清晰、规范的命名（例如，使用下划线代替空格），因为它们会直接用作音频文件名，也是速记卡模块追踪进度的唯一标识。
*   **文件组织**:
    *   **标准词表**: `.py` 文件直接放在 `word_lists/` 目录下。
    *   **图文词表**: `.py` 文件放在 `dialect_visual_wordlists/` 目录下。**所有相关的图片都应放在 `dialect_visual_wordlists/` 目录下一个与该 `.py` 文件同名的子文件夹中**。
    *   **速记卡词表**: `.py` 文件建议放在 `flashcards/common_wordlists/` (标准) 或 `flashcards/visual_wordlists/` (图文) 中，以便与采集用的词表分开管理。

### 数据备份与迁移
您的所有工作都是以普通文件的形式存储的，备份和迁移非常简单。您只需要定期备份以下文件夹即可：

*   `word_lists/` (标准词表)
*   `dialect_visual_wordlists/` (图文词表及图片)
*   `flashcards/` (速记卡专用词表、音频和学习进度)
*   `audio_record/` (所有语音包和方言图文录音)
*   `audio_tts/` (通用TTS输出)
*   `Results/` (所有口音采集会话数据)
*   `config/settings.json` (您的个人设置)

### 自定义主题
您可以参考 `themes` 文件夹下的 `.qss` 文件，创建自己的样式表，并放入该文件夹，重启程序后即可在设置中选择。

---

## 四、常见问题 (FAQ)

### 安装与环境问题
**问：为什么提示“依赖库缺失”？**
答：请根据提示运行 `pip install ...` 命令来安装所有必需的Python库。特别是新功能可能需要 `thefuzz`、`python-Levenshtein`（用于智能检测与自检）以及 `markdown`（用于显示本帮助文档）。

**问：为什么保存MP3格式的录音会失败？**
答：这通常是因为您的系统中缺少 LAME MP3 编码器库。这是一个版权问题，很多音频处理库默认不包含它。您可以在设置中将录音格式切换为无损的 WAV 格式，或者为您的操作系统安装 LAME 编码器（例如，在macOS上使用 `brew install lame`）。

### 功能使用问题
**问：为什么图文采集时提示“找不到图片”？**
答：请检查：
1.  您的图片是否放在了与图文词表 `.py` 文件**同名**的子文件夹中？
2.  图文词表中的 `image_path` 字段是否正确填写了图片的文件名？

**问：为什么“智能检测”没有反应？**
答：请确保您已经通过 `pip install thefuzz python-Levenshtein` 安装了模糊匹配库。

---

## 五、关于与致谢
**PhonAcq Assistant** 的开发旨在为语言学研究社区提供一个现代化、开源、易用的工具，以促进学术研究的效率和数据的规范性。

感谢所有为此项目提供建议和反馈的用户！